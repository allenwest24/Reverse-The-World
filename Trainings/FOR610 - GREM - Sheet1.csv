Term,Ellaborate,Book,Page
Malware ,"- Code that is used to perform malicious actions.
- Less about capabilities and more about the use.
- Typically a person behind the malware.",1,5
Input to REM Staff,"- Verbal reports
- suspicious files
- file system image
- memory image
- network logs
- anomaly observations",1,10
Output from REM Staff,"- What malware does
- How to identify it
- attacker's profile
- IR recommendations
- reports and IOC's
- Malware trends",1,10
Formal Report of Malicious Program,"- Summary of the analysis: key takeaways
- Identifications: file type, name, size, hashes, malware names, current detection capabilities
- Characteristics: capabilities for infecting files, self-preservation, spreading, leaking data, interation with attacker, etc.
- Dependencies: Files and network resources needed, OS versions, custom DLLs, executables, URLs, scripts
- Behavioral and code analysis findings: behavioral, static, and dynamic observations.
Supporting figures: logs, pics, strings, functions
- Incident recommendations: IOCs, eradication steps.",1,11
Virus Total,- Exports: table showing list of functions that were designed to be invoked outside of the DLL,1,14
Hybrid Analysis by Payload Security,"- Free website
- Details on behavior of specimen
- Detonates sample in a sandbox
- Identifies mutants",1,15
Mutant (mutex),"-  serves as a flag that programs can use to serialize access to a
resource.
- These flags are sometimes used by malware to avoid reinfecting the host, acting as infection
markers.",1,15
PassiveTotal,"- Provides historic information about the IP addresses to
which malware resolved over time, network details for those IPs, and indicators that those resources were associated with malicious activities.",1,16
Open Threat Exchange,"- Details about hostnames, mutant values, dropped files, signatures",1,17
Network Traffic to/from malware,"- Beaconing
- C2
- Exfil",1,19
Beaconing,- periodic messages to adversary with info on the state of the program and host,1,19
Command and Control,"- Obtaining instructions from the adversary
regarding actions that the specimen needs to perform, such as upgrade itself or scan a host.",1,19
Exfiltration,"- Sending stolen data, such as keystroke logs, to the adversary.",1,19
Self-Defending,"- Detect virtualization
- Detect debuggers or dissasemblers",1,29
Patching,- Editing parts of the malware that detects virtualization or tools.,1,30
CloneZilla,- Disk cloning for use of physical devices instead of VMs.,1,32
FOG,- Disk cloning for use of physical devices instead of VMs.,1,32
dd,- Disk cloning for use of physical devices instead of VMs.,1,32
Deep Freeze,"- Snapshot functionality but for physical devices.
- Not as reliable
- Malware can target aspect of these programs.",1,32
RollBack Rx,"- Snapshot functionality but for physical devices.
- Not as reliable
- Malware can target aspect of these programs.",1,32
PXE Booting,- Restore a clan system image over the network.,1,32
82,"- PeStudio
- strings
- CFF Explorer
- perframe
- Detect It Easy
- signsrch: Locates code used for crypto, compression, and more.
- pescan and PortEx: examine key aspects opf Windows executable files and identify some anomalies.
- MASTIFF: extracts many details from various types of malware; good for bulk review of many samples
- Exiftool: displays metadata embedded in files of various types
- TrID: Identifies the type of file you're starting to examine.
- Viper: Manages the malware collection and extracts various static properties about the files.",1,"33, 48"
Behavioral Analysis Tools,"- Process Hacker
- Process Monitor
- RegShot
- Wireshark
- fakedns",1,33
Code Analysis Tools,"- Ghidra
- x64dbg/x32dbg
- OllyDumpEx
- jmp2it
- Scylla",1,33
strings,"- Present on most linux distributions
- By default extracts only ASCII-encoded strings
- extract unicode strings by specifying --encoding=l
- -a examines the whole file rather than solely the initialized and loaded sections of object files.",1,42
pestr,"- Similar to strings utility
- part of the Pev toolkit which is for examining windows executables
- --net extracts only those strings that look like network related details such as hostnames and IP addresses.",1,42
PeStudio,"- Free Windows tool that can display static properties
- Calculates various hash values
- ""indicators"" area automatically highlights potentially malicious aspects of the Windows executable.
- Displays contents of the specimens import table in ""imports""
- Perframe is an alternative.",1,44-46
PE (Portable Executable),"- Windows executables follow this format.
- Specifically formatted ehader that contains the details the operating system needs to load the file into memory and set up the runtime environment.
- Tools that use this include PeStudio, Detect It Easy (DIE), and Exeinfo PE.
- Can reveal how a file was packed.",1,47
Packing,"- PE header can reveal information about how a file was packed, and DIE and Exeinfo can help with this.",1,47
Exeinfo PE,"- Gathers information about PE headers in windows executables
- Helps understanding how a file was packed.
- can rip a file from within embedded artifacts.",1,47
Process Hacker,"- open-source tool designed to help analysts ""monitor system resources, debug software, and detect malware""
- replacement for task manager which is built into windows.
- Alternative is process explorer.
- Network tab shows only the connections active at a given moment.
- Terminate a process by right clicking it and selecting Terminate. Or press Del on keyboard.",1,52
Process monitor,"- Free from Microsoft
- Shows real time file system, registry, and process/thread activity of processes on the infected windows lab system, recording all observed actions in a detailed log file.
- Shows files being accessed, registry keys being queried or set.
- Ctrl + E or click the magnifying gladd to pause capture until ready.
- Ctrl + X or click eraser to clear logs
- Each line shows process name, PID, operation, and path.
- Records results of operations.
- Filter down noise by going to the filter menu or pressing Ctrl + L
- Save filters and load filters to eliminate known windows noise for multiple projects. These filters are stored in PMF files.",1,"52, 54, 60"
ProcDOT,"- Companion tool to process monitor that examines key aspects of the process moniotr log in a convinient manner.
- Free",1,52
Regshot,"- Open source tool enables analysts to determine how the malicious program changes the state of the file system and the registry of its host during the infection.
- Used to compare the state of the system before and after the infection, and generates a report to highlight changes.
- 1st Shot, 2nd shot, compare
- Cannot provide information about the specific sequence of events or temporary changes between shots. Also doesn't show what process is responsible for these changes.",1,"52, 60"
Wireshark,"- Popular open source network sniffer.
- Observe network traffic.
- Maintains a historical record but doesnt specify which local process was involved in the connection.
- Activate capture by clicking eth0 on right side or by pressing Ctrl + E
- Right click a packet that is part of an HTTP connection and select 'Follow TCP Stream'.",1,52
TcpLogView,"- free tool
- monitors opened TCP connections on your system and adds a new log line every time that a TCP connection is opened or closed.
- Solves the accountability of past connections from Process Hacker and Wireshark.",1,52
"HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\brbbot,","- Registry key causing program brbbot to run automatically.
- Presistent mechanism.",1,60
\??\C:\Users\REM\AppData\Roaming\brbconfig.tmp.,"- Registry key that stores the names of files to be renamed whent he system restarts.
- When a program renames a file that is currently in use.",1,60
.pf file extension,"- Files that are automatically generated by Windows to allow the OS to start the process a bit faster the next time it runs.
- Creation or modification of these allow for insight into the specific programs that were executed duering the period between two regshots.",1,60
ProcDOT,"- Tool to correlate, filter, and visualize contents of process monitor logs and PCAP network sniffer capture files.
- Export process monitor to csv with Ctrl + S
- To load your log files into ProcDOT, point ProcDOT to the Process Monitor CSV file by pressing the ""..."" button in the Procmon area. Then click the ""..."" button in the Launcher area.
- automatically assigns the light gray color to the processes that were present on the system before Process Monitor began capturing data and presents you with the remaining black-colored process names and IDs.
- Generate the activity diagram by clicking the Refresh button.
- Can also import PCAPs.",1,63-65
fakedns,"- Utility that automatically responds to DNS queries with the IP of the host on which it runs.
- Alternative is making an entire DNS server or modifying the ""hosts"" file on the infected host.
- run by typing fakedns
- Alternative is the InetSim DNS emulator",1,67
"RST, ACK","- Packet sent back to a SYN indicating that a connection cannot be established.
- This can be solved by starting upa  web server on where it is trying to reach. Direct this with fakedns to your lab.
- httpd start",1,"69, 71"
SciTE,"- Text editor
- scite encoded.hex",1,75
xxd,"- xxd -r -p encoded.hex  --> hex to ascii
- xxd -r -p encoded.hex > encoded.raw --> hex to raw
- -r to reverse or convert back to text
- View contents of a bianry file into a readable hex dump.",1,"75, 97"
Dissassemblers and Debugger Tools,"- Ghidra
- x64dbg
- IDA
- Windbg
- Radare2
- Binary Ninja
- Hopper",1,80
Dissassembling,"- Process of translating binary machine-level instructiions that the processor understands to assembly language code that's easier for humans to understand.
- Tools that accomplish this are called dissassemblers
- A modern disassembler is
expected to not only perform the core translation work, but also to intelligently distinguish between code and data embedded into the executable, provide comments and labels, and otherwise help the analyst's reverse-engineering efforts.",1,81
Static analysis,- Using a dissassembler to examine a specimen's code without actually executing it,1,81
Dynamic analysis,"- Opposite of static analysis
- Involves actually running the program while examining its activities at the assembly level.
- Debuggers are tools designed for this.",1,81
Debuggers,"- Tools with built-in dissassemblers to aid in static and dynamic reverse engineering activities.
- x64dbg is an example.
- ""spy"" on the parameters the program passes to external
functions, as well as to examine the return values of API calls.",1,81
x64dbg,"- Capable dsebugger for Windows executables
- Open source.
- Convinient UI that reverse-engineers can use to navigate through the specimen to perform static and dynamic code-level analysis
- Enable susers to install plugins and write scripts to extend the functionality.
- Can handle 32-bit and 64-bit code (x32dbg and x64dbg)
- Load specimen by dragging the executable icon on top of the x64dbg icon.
- Can also use File>Open (F3)
- Upon loading, pauses in the beginning of the programs code before it has a chance to run.
- Dissassembler built in is called views.
- Second column is hexidecimal relative address or offset.
- Third column shows spaced out hexidecimal instructions that the processor can recognizze and execute.
- Next column is the human-readable assembly 
- Last column is comments, often auto-generated.
- Debug menu lets you run, single-step, or set breakpoints
- Interact by typing commands in the bottom left corner
- Set a breakpoint on an API call: SetBPX Readfile (or bpx or bp)
- View breakpoints in the breakpoint tab.
- After setting breakpoint, Debug > Run
- To find which parameters are being passed into a funciton, look at the middle region on the right side of the CPU tab.
- Run to user code in debug menu (Alt+F9)",1,"82, 83"
breakpoint,"- Setting one of the code that a .exe might use to read a .tmp file from the file system will bring us to the general vacinity of the code the specimen uses to decipher the files contents
- In x64dbg: SetBPX APINAME (also can use bpx and bp)",1,84
Windows APIs,"- Code references these to manipulate the system.
- Useful to find which of these the code is using to find out what the instrcutions do.
- Look at the specimens import table using PeStudio",1,84
RIP,"- Current or next instruction to execute.
- RIP is the register for the next instruction on 64-bit whereas EIP is the same for 32-bit.",1,85
rcx,- Register that 64-bit code uses for supplying the first parameter to a function.,1,87
handle,"- Found in handles tab of x64dbg
- Can also be found in the Process Hacker tool.",1,88
Run to user code,"- Debug menu of x64dbg and select Run to user code (Alt+F9).
- Fully loads the file and the gets to where the developer code starts.",1,89
Call Stack,"- Shows how specimen found itself.
- shows a path of nested function in reverse call order.
- Top line
- ""From"" is where we are currently paused.
- ""To"" is where we will return to.",1,89
Call,- Typical operand in an instruction in which functions are invoked in assembly,1,90
Run until Selection,"- Useful when you want to find the value of some operation..
- Call on the instruction immediatly following an API call like CryptDecrypt.",1,91
API Monitor,"- Tool to examine API calls made by the processes running on Windows systems.
- Free
- Simpler and faster alternative to going through with a debugger to identify API calls.
- Has filters for what kinds of API calls we care about.
- Displays what parameters were passed to the external function and what data was returned by the function.
- Faster, but sometimes less control and detail than a debugger",1,94
Boolean XOR,"- Method used to obfuscate strings
- Simple implementation makes it popular.
- XOR each chracter with a one byte key value
- To decode, do the same operation.
- Key is stored in a config file or within the executable.
- Get to raw format with xxd
- translate.py encoded.raw decoded.txt 'byte ^ 0x5b'
or
- perl -pe 's/(..)/chr(hex($1)^0x5b)/ge' encoded.hex > decoded.txt",1,96
"ROR, ROL, ROT","- ROR rotates each byte in a string to the right
- ROL is same but to the left.
- ROT rotates each letter in the alphabet.",1,96
INetSim,"- Observe SSL encrypted data after it is decrypted.
- Emulates HTTPS, SMTP, FTP, POP3, TFTP, IRC
- /etc/inetsim/inetsim.conf is the main configuration file of INetSim. It enables you to define which services INetSim should emulate. It also enables you to define service-specific options, such as listening ports, static DNS mappings, HTTP response parameters, SSL configuration details, and so on.
- /var/log/inetsim contains the inetsim log files. The most useful of these files is service.log which cointains details about the requests inetsim received and the responses it sends.
- /var/lib/inetsim contains data files used by INetSim emulators, such as the files provided by the HTTP emulator or the certificate used for SSL encryption for the HTTPS emulator.
- DNS emulator built into INetSim by editing the inetsim.conf file, removing the comment mark from the line start_service dns, and changing the dns_default_ip value to point to the IP address of your REMnux system.
- intetsim (to run)
- ""This is the INetSim default binary"" is the default response to requests.
- ""more /var/log/inetsim/service.log"" to see details of the connection
- This tool looks at the server side of the connection.",1,109-111
Fiddler,"- Client side version of InetSim
- Intercepts local HTTP and HTTPS traffic
- Tools>Options, ""Captrue HTTPS CONNECTs"" and ""Decrypt HTTPS traffic"", ""Ignore server certificate errors (unsafe)""
- automatically generate responses to HTTP and HTTPS requests
- To enable this feature, you need to go to the AutoResponder tab and enable the checkbox called ""Enable rules,""
- To see the properties, you need to select the HTTPS connection, go to the Inspectors tab, and then go to the Raw tab.",1,116
ip-tables,"- powerful Linux-based firewall
- NAT capabilities that can be used to intercept and redirect network connections going through all possible IP addresses.
- Windows virtual machine needs to be configured to point to the REMnux virtual machine's IP as its default gateway
- To enable iptables traffic redirection on most Linux systems, you can use this command:
iptables -t nat -A PREROUTING -i eth0 REDIRECT
- To disable this capability, you could reboot the Linux system or enter the following command:
iptables -t nat -D PREROUTING -i eth0 -j REDIRECT
- the accept-all-ips command, as shown at the bottom of the slide. This is a wrapper script around iptables. In addition to enabling IPv4 traffic redirection, the script also instructs iptables to handle IPv6 traffic.
- accept-all-ips start",1,117-118
Netcat,"- When we dont know what protocol a specimen will use.
- Can listen on any arbitrary port.
- Netcat will accept a connection on the port you designate, and send
whatever data it receives as a payload of that connection to STDOUT.
- -l to listen
- -p specifies listening port
- -n directs netcat to avoid trying to resolve the connecting IP addresses to hostnames.
- Can help receive a connection and save the payload to a file.",1,118
MZ,- Character sequence that is part of the PE header structure that carries the MS-DOS compatible header data and designated the file as an MS-DOS compatible program.,1,118
Behavioral Interaction Observation Tools (Additional),"- TcpLogView: Maintains a historical log of local TCP connections, showing which process handled which connection.
- PE Capture: Records and captures local PE files that try to run.
- PolarProxy: Intercepts and decrypts SSL/TLS traffic in the lab.
- ApateDNS: DNS server for redirecting hostname resolution requests; similar to fakedns but runs on Windows.
- FakeNet-NG: Intercepts network traffic in the lab, emulating common protocols; similar to INetSim but runs on Windows.",1,124